<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Frequently Asked Questions • vivainsights</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Frequently Asked Questions"><meta property="og:image" content="https://microsoft.github.io/vivainsights/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">vivainsights</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-analyst-guide" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Analyst Guide</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-analyst-guide"><li><a class="dropdown-item" href="analyst_guide_intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="analyst_guide_getting_started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="analyst_guide_data_validation.html">Data Validation</a></li>
    <li><a class="dropdown-item" href="analyst_guide_reports.html">Reports</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/intro-to-vivainsights.html">Introduction to vivainsights</a></li>
    <li><a class="dropdown-item" href="articles/best-practices.html">Best Practices when using vivainsights</a></li>
    <li><a class="dropdown-item" href="articles/network-analysis.html">Introduction to Organizational Network Analysis with vivainsights in R</a></li>
    <li><a class="dropdown-item" href="articles/exploratory-rank.html">Identifying noteworthy groups with rank functions</a></li>
    <li><a class="dropdown-item" href="articles/pairwise-chisq.html">Running pairwise chi-square tests with vivainsights</a></li>
    <li><a class="dropdown-item" href="articles/information-value.html">Information Value analysis with vivainsights</a></li>
    <li><a class="dropdown-item" href="articles/custom-network-p2p.html">Plotting a Network Graph using network_p2p</a></li>
    <li><a class="dropdown-item" href="articles/custom-network-g2g.html">Plotting a Network Graph using network_g2g</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="faq.html">FAQ</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/microsoft/vivainsights/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Frequently Asked Questions</h1>
      <small class="dont-index">Source: <a href="https://github.com/microsoft/vivainsights/blob/main/.github/faq.md" class="external-link"><code>.github/faq.md</code></a></small>
    </div>

<div id="frequently-asked-questions" class="section level1">

<div class="section level2">
<h2 id="general">General<a class="anchor" aria-label="anchor" href="#general"></a></h2>
<div class="section level3">
<h3 id="why-should-i-use-r-for-viva-insights">Why should I use R for Viva Insights?<a class="anchor" aria-label="anchor" href="#why-should-i-use-r-for-viva-insights"></a></h3>
<p>R is an open-source statistical programming language and one of the most popular toolkits for data analysis and data science. There are four key reasons why a Viva Insights analyst might choose to use R instead of other alternatives:</p>
<ol style="list-style-type: decimal"><li>R has an <strong>immense package eco-system</strong> with over <a href="https://cran.r-project.org/web/packages/" class="external-link">22,100 packages</a> for advanced applications from building random forest models to Organizational Network Analysis (ONA) graph visualizations. This enables analysts to perform specialized and more in-depth analysis for specific Viva Insights use cases, such as predicting employee churn by analyzing Viva Insights metrics.</li>
<li>There are <strong>no licensing costs</strong> with R, which enables analysts to leverage the powerful functionality with no additional cost.<br></li>
<li>R has a code-oriented workflow (as opposed to point-and-click), which promotes <strong>reproducibility</strong>. This is valuable for improving the quality of the analysis and for efficiently replicating analysis with different data samples.</li>
<li>R also has a <strong>substantial user community</strong>, which analysts can access to support and augment their analysis capabilities.</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="installation-and-setup">Installation and Setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a></h2>
<div class="section level3">
<h3 id="which-version-of-r-should-i-use">Which version of R should I use?<a class="anchor" aria-label="anchor" href="#which-version-of-r-should-i-use"></a></h3>
<p>You are recommended to use the latest stable version of R. You can find the latest version on <a href="https://www.r-project.org/" class="external-link uri">https://www.r-project.org/</a>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-install-from-a-development--experimental-branch-of-the-package">How do I install from a development / experimental branch of the package?<a class="anchor" aria-label="anchor" href="#how-do-i-install-from-a-development--experimental-branch-of-the-package"></a></h3>
<p>If you wish to install a version of the package from any branch <strong>other than the main branch</strong>, you can run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_git</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com/microsoft/vivainsights.git"</span>,</span>
<span>                      branch <span class="op">=</span> <span class="st">"&lt;BRANCH-NAME&gt;"</span>, <span class="co"># Replace</span></span>
<span>                      build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>You should replace the <code>&lt;BRANCH-NAME&gt;</code> with the name of your target branch, such as <code>"feature/network-functions"</code>.</p>
</div>
<div class="section level3">
<h3 id="should-i-install-r-to-my-onedrive-or-a-cloud-folder">Should I install R to my OneDrive or a cloud folder?<a class="anchor" aria-label="anchor" href="#should-i-install-r-to-my-onedrive-or-a-cloud-folder"></a></h3>
<p>No, you should not. You should never install the default directory for R to OneDrive, as R is a program and you are likely to experience significant cloud syncing issues if you do so. If you use Windows and have experienced this issue, please uninstall and follow the below steps for re-installation:</p>
<ol style="list-style-type: decimal"><li>Install RStudio to the default directory, e.g. <code>C:\Program Files\R\R-4.X.X\library\base\R\Rprofile</code>
</li>
<li>Change the default RStudio package installation location so that it does not save to OneDrive, or another cloud drive. This ensures that OneDrive doesn’t attempt to upload the thousands of files that will be downloaded via the installation of the packages. The R folder where these packages install to is by default created in the Documents folder, which by automatically syncs with OneDrive. We will be moving the installation path to our local <code>C:</code> drive instead to prevent this.</li>
<li>Create a local folder. Open <code>File Explorer</code> -&gt; <code>C:</code> drive -&gt; <code>Create New Folder</code> -&gt; Name it <code>"R"</code>
</li>
<li>Change permissions:
<ul><li>If you installed RStudio in the default directory, the path to your RProfile file is <code>C:\Program Files\R\R-4.X.X\library\base\R\Rprofile</code>
</li>
<li>Navigate to <code>C:\Program Files\R\R-4.X.X\library\base\</code>
</li>
<li>Double-click the base folder so that you’re looking at its contents, which include the R subfolder.</li>
<li>Right-click on the R subfolder and select Properties.</li>
<li>Click on the <code>Security</code> tab.</li>
<li>Click on the <code>Edit</code> button.</li>
<li>Scroll down the Group or user names pane and click on the Users line near the bottom of that list.</li>
<li>In the <code>Permissions for users</code> pane, click on the <code>Full Control</code> checkbox under <code>Allow</code>.</li>
<li>Click OK and OK again to save and exit these windows.</li>
</ul></li>
<li>Edit the <code>Rprofile</code> file:
<ul><li>Ensure that RStudio is closed.</li>
<li>Navigate to <code>C:\Program Files\R\R-4.X.X\library\base\R\</code>
</li>
<li>Open the <code>Rprofile</code> file with your preferred text editor.</li>
<li>Save a copy of the file in the same directory and name it <code>"RProfileBackup.txt"</code>.</li>
<li>Reopen the <code>Rprofile</code> file with your preferred text editor.</li>
<li>Replace the string <code>Sys.getenv("R_USER")</code> with the string <code>"C:/R"</code>
<ul><li>Ensure you are replacing the string <code>Sys.getenv("R_USER")</code> and NOT the string <code>Sys.getenv("R_LIBS_USER")</code>
</li>
<li>The string <code>"C:/R"</code> should align with the directory where you created the folder in step 3a</li>
<li>Reference the <code>RProfileBackup.txt</code> as a backup if OneDrive uploads the package files after installation</li>
</ul></li>
<li>Save the file and close out of your text editor and File Explorer.</li>
</ul></li>
</ol><p>You should then be able to install the <strong>vivainsights</strong> library by opening RStudio and running the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if remotes is installed, if not then install it</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"remotes"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"microsoft/vivainsights"</span>, upgrade <span class="op">=</span> <span class="st">"never"</span><span class="op">)</span></span></code></pre></div>
<p>You can then restart RStudio with <code>Ctrl</code> + <code>Shift</code> + <code>F10</code> in Windows.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-export-the-outputs-of-my-analysis-to-excel">How do I export the outputs of my analysis to Excel?<a class="anchor" aria-label="anchor" href="#how-do-i-export-the-outputs-of-my-analysis-to-excel"></a></h3>
<p>The <code><a href="reference/export.html">export()</a></code> function allows you to export the outputs of your analysis to Excel in two ways.<br>
1. By setting <code>method</code> to <code>"clipboard"</code> and passing a data frame through to <code><a href="reference/export.html">export()</a></code> , the results will be copied to your clipboard and you can paste it through to Excel. 2. By setting <code>method</code> to <code>"csv"</code>, a CSV file will be saved in the specified path relative to your current working directory. The CSV file can then be opened in Excel.</p>
<p>If you would like to export a <em>list</em> of data frames to Excel where (i) each data frame in the list corresponds to a <em>Worksheet</em> and (ii) the name of each list member corresponds to the <em>Sheet name</em>, you can use <code>writexl::write_xlsx()</code>. <strong>vivainsights</strong> does not depend on functions from <strong>writexl</strong>, so you may need to load and install it separately.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-and-visualization">Analysis and Visualization<a class="anchor" aria-label="anchor" href="#analysis-and-visualization"></a></h2>
<div class="section level3">
<h3 id="how-do-i-filter-by-specific-date-ranges">How do I filter by specific date ranges?<a class="anchor" aria-label="anchor" href="#how-do-i-filter-by-specific-date-ranges"></a></h3>
<p>We recommend using <strong>dplyr</strong> (which is loaded in as part of <strong>tidyverse</strong>) for data manipulation. To filter down to a specific date range in a Person Query, you can run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://microsoft.github.io/vivainsights/">vivainsights</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># Or load dplyr separately</span></span>
<span></span>
<span><span class="co"># Read a Person Query from local directory</span></span>
<span><span class="co"># Assign it to `raw_pq`</span></span>
<span><span class="va">raw_pq</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_query.html">import_query</a></span><span class="op">(</span><span class="st">"data/person query.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign filtered data frame to `clean_pq`</span></span>
<span><span class="va">clean_pq</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">raw_pq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"08/30/2024"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"12/19/2024"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The above example filters the date range from the week commencing 30th of August 2024 to the week ending 19th of November 2024 inclusive. Note that the first date is a Sunday (beginning of the week) and the second date is a Saturday (end of the week). If you query is run by <strong>day</strong>, you should specify the <em>after</em> filter as the exact last day, rather than the Saturday of the week.</p>
<p>In some scenarios, you may also want to exclude a particular week from the data. You can use a similar approach:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_pq2</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">clean_pq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"11/22/2024"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The above line of code excludes the week of 22nd of November 2024, using the operator <code>!=</code> to denote <em>not equal to</em>. Conversely, you can isolate that single week by replacing <code>!=</code> with <code>==</code>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-create-a-custom-hr-variable">How do I create a custom HR variable?<a class="anchor" aria-label="anchor" href="#how-do-i-create-a-custom-hr-variable"></a></h3>
<p>The most common way to create a ‘custom HR variable’ is to create a categorical variable from one or more numeric variables. You may want to do this if you are trying to <em>bin</em> a numeric variable or create a custom rule-based segmentation with Viva Insights metrics.</p>
<p>Here is an example of how to create a categorical variable (<code>N_DirectReports_NET</code>) with a numeric variable representing the number of direct reports, using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> .</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://microsoft.github.io/vivainsights/">vivainsights</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># Or load dplyr</span></span>
<span></span>
<span><span class="va">clean_pq_with_new_var</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">clean_pq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="co"># Standard Person Query</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>N_DirectReports_NET <span class="op">=</span></span>
<span>         <span class="fu">case_when</span><span class="op">(</span><span class="va">NumberofDirectReports</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"0"</span>,</span>
<span>                   <span class="va">NumberofDirectReports</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"1"</span>,</span>
<span>                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"2 to 5"</span>,</span>
<span>                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"6 to 10"</span>,</span>
<span>                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">20</span> <span class="op">~</span> <span class="st">"Up to 20"</span>,</span>
<span>                   <span class="va">NumberofDirectReports</span> <span class="op">&gt;=</span> <span class="fl">21</span> <span class="op">~</span> <span class="st">"21 +"</span>,</span>
<span>                   <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> creates a new column, whereas <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> runs an if-else operation to classify numeric ranges to the right hand side of the <code>~</code> symbol. When the expression on the left hand side evaluates to <code>TRUE</code>, the value on the right hand side is assigned to the new column. At the end of the code, you will see that anything that doesn’t get classified gets an ‘error handling’ value. If a value ends up as “Not classified”, you should check whether there may be gaps in your <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> chunk that is not capturing all the values.</p>
<p>Once you have created this new variable and checked that the classifications are correct, you can further your analysis by using it as an HR attribute, such as:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_pq_with_new_var</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="reference/keymetrics_scan.html">keymetrics_scan</a></span><span class="op">(</span>hrvar <span class="op">=</span> <span class="st">"N_DirectReports_NET"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Chan, Carlos Morales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>NULL Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

